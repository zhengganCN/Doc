# 内置中间件

ASP.NET Core 附带以下中间件组件。 “顺序” 列提供备注，以说明中间件在请求处理管道中的放置，以及中间件可能会终止请求处理的条件。 如果中间件让请求处理管道短路，并阻止下游中间件进一步处理请求，它被称为“终端中间件” 。 若要详细了解短路，请参阅使用 IApplicationBuilder 创建中间件管道部分。

| 中间件                     | 描述                                                                                      | 顺序                                                                |
| -------------------------- | ----------------------------------------------------------------------------------------- | ------------------------------------------------------------------- |
| 身份验证                   | 提供身份验证支持。                                                                        | 在需要 HttpContext.User 之前。 OAuth 回叫的终端。                   |
| Cookie 策略                | 跟踪用户是否同意存储个人信息，并强制实施 cookie 字段（如 secure 和 SameSite）的最低标准。 | 在发出 cookie 的中间件之前。 示例：身份验证、会话、MVC (TempData)。 |
| CORS                       | 配置跨域资源共享。                                                                        | 在使用 CORS 的组件之前。                                            |
| 异常处理                   | 处理异常。                                                                                | 在生成错误的组件之前。                                              |
| 转接头                     | 将代理标头转发到当前请求。                                                                | 在使用已更新字段的组件之前。 示例：方案、主机、客户端 IP、方法。    |
| 运行状况检查               | 检查 ASP.NET Core 应用及其依赖项的运行状况，如检查数据库可用性。                          | 如果请求与运行状况检查终结点匹配，则为终端。                        |
| HTTP 方法重写              | 允许传入 POST 请求重写方法。                                                              | 在使用已更新方法的组件之前。                                        |
| HTTPS 重定向               | 将所有 HTTP 请求重定向到 HTTPS。                                                          | 在使用 URL 的组件之前。                                             |
| HTTP 严格传输安全性 (HSTS) | 添加特殊响应标头的安全增强中间件。                                                        | 在发送响应之前，修改请求的组件之后。 示例：转接头、URL 重写。       |
| MVC                        | 用 MVC/Razor Pages 处理请求。                                                             | 如果请求与路由匹配，则为终端。                                      |
| OWIN                       | 与基于 OWIN 的应用、服务器和中间件进行互操作。                                            | 如果 OWIN 中间件处理完请求，则为终端。                              |
| 响应缓存                   | 提供对缓存响应的支持。                                                                    | 在需要缓存的组件之前。                                              |
| 响应压缩                   | 提供对压缩响应的支持。                                                                    | 在需要压缩的组件之前。                                              |
| 请求本地化                 | 提供本地化支持。                                                                          | 在对本地化敏感的组件之前。                                          |
| 路由                       | 定义和约束请求路由。                                                                      | 用于匹配路由的终端。                                                |
| 会话                       | 提供对管理用户会话的支持。                                                                | 在需要会话的组件之前。                                              |
| 静态文件                   | 为提供静态文件和目录浏览提供支持。                                                        | 如果请求与文件匹配，则为终端。                                      |
| URL 重写                   | 提供对重写 URL 和重定向请求的支持。                                                       | 在使用 URL 的组件之前。                                             |  |
| WebSockets                 | 启用 WebSockets 协议。                                                                    | 在接受 WebSocket 请求所需的组件之前。                               |

[详情参见：https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/middleware/?view=aspnetcore-2.2#built-in-middleware](https://docs.microsoft.com/zh-cn/aspnet/core/fundamentals/middleware/?view=aspnetcore-2.2#built-in-middleware)
