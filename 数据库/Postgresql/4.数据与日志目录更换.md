# 数据目录更换

## 在初始化数据库的时候修改数据目录

``` shell
# 切换至postgres用户
su - postgres

# 启动postgresql命令行程序
psql

# 初始化数据库，并指定数据目录
initdb -D /data/pgsql/data;

# 退出postgresql命令行程序
\q

# 退出postgres用户
exit
```

## 如果数据库初始化好了，可以通过修改数据库配置文件的相关配置来修改数据目录

* 关闭数据库

  systemctl stop postgresql

* 获取数据库配置文件

  1. 默认路径为 `/var/lib/pgsql/data/postgresql.conf`

  2. 修改数据目录配置 `data_directory` 的值，如`data_directory = '/data/pgsql/data'`

  3. 修改数据目录配置 `log_directory` 的值，如`log_directory = '/data/pgsql/log'`

* 把`/var/lib/pgsql/data`目录的文件(包括目录)全都移动到修改后的数据目录中（不包括以.conf结尾的配置文件，如：`postgresql.conf`），如`/data/pgsql/data`中。把`/data/pgsql`及其子目录的所有者设置为`postgres`,并设置权限为`700`。

  相关命令为:

  ```shell
  #修改文件所有者
  chown -R postgres /data/pgsql
  #修改文件权限
  chmod -R 700 /data/pgsql
  ```

* 启动数据库

  systemctl start postgresql
